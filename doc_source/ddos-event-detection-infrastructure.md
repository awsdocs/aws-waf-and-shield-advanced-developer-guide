# Detection logic for infrastructure layer threats<a name="ddos-event-detection-infrastructure"></a>

The detection logic used to protect targeted AWS resources against DDoS attacks in the infrastructure layers \(layer 3 and layer 4\) depends on the resource type and whether the resource is protected with AWS Shield Advanced\. 

**Detection for Amazon CloudFront and Amazon Route 53**  
When you serve your web application with CloudFront and Route 53, all packets to the application are inspected by a fully inline DDoS mitigation system, which does not introduce any observable latency\. DDoS attacks against CloudFront distributions and Route 53 hosted zones are mitigated in real time\. These protections apply regardless of whether you use AWS Shield Advanced\.

Follow the best practice of using CloudFront and Route 53 as the entry point of your web application wherever possible for the fastest detection and mitigation of DDoS events\.

**Detection for AWS Global Accelerator and regional services**  
Resource\-level detection protects AWS Global Accelerator standard accelerators and resources that are launched in AWS Regions, like Classic Load Balancers, Application Load Balancers, and Elastic IP addresses \(EIPs\)\. These resource types are monitored for traffic elevations that may indicate the presence of a DDoS attack that requires a mitigation\. Every minute, traffic to each AWS resource is evaluated\. If traffic to a resource is elevated, additional checks are performed to measure the capacity of the resource\. 

Shield performs the following standard checks: 
+ **Amazon Elastic Compute Cloud \(Amazon EC2\) instances, EIPs attached to Amazon EC2 instances** – Shield retrieves capacity from the protected resource\. The capacity depends on the target’s instance type, instance size, and other factors such as whether the instance is using enhanced networking\.
+ **Classic Load Balancers and Application Load Balancers** – Shield retrieves capacity from the targeted load balancer node\.
+ **EIPs attached to Network Load Balancers** – Shield retrieves capacity from the targeted load balancer\. The capacity is independent of the target load balancer's group configuration\.
+ **AWS Global Accelerator standard accelerators** – Shield retrieves capacity, which is based on the endpoint configuration\.

These evaluations occur across multiple dimensions of network traffic, such as port and protocol\. If the capacity of the targeted resource is exceeded, Shield places a DDoS mitigation\. The mitigations placed by Shield will reduce DDoS traffic, but might not eliminate it\. Shield may also place a mitigation if a fraction of the resource’s capacity is exceeded on a traffic dimension that's consistent with known DDoS attack vectors\. Shield places this mitigation with a limited time to live \(TTL\), which it extends as long as the attack is ongoing\.

**Note**  
Mitigations placed by Shield will reduce DDoS traffic, but may not eliminate it\. You can augment Shield with solutions like AWS Network Firewall or an on\-host firewall like iptables to prevent your application from processing traffic that is not valid for your application or was not generated by legitimate end users\.

Shield Advanced protections add the following to the existing Shield detection activities: 
+ **Lower detection thresholds** – Shield Advanced places mitigations at one half of the calculated capacity\. This can provide faster mitigations for attacks that ramp up slowly and mitigation of attacks that have a more ambiguous volumetric signature\. 
+ **Intermittent attack protection** – Shield Advanced places mitigations with an exponentially increasing time to live \(TTL\), based on the frequency and duration of attacks\. This keeps mitigations in place longer when a resource is frequently targeted and when an attack occurs in short bursts\. 
+ **Health\-based detection** – When you associate a Route 53 health check with a Shield Advanced protected resource, the status of the health check is used in the detection logic\. During a detected event, if the health check is healthy, Shield Advanced requires greater confidence that the event is an attack before placing a mitigation\. If instead the health check is unhealthy, Shield Advanced might place a mitigation even before confidence has been established\. This feature helps avoid false positives and provides quicker reactions to attacks that affect your application\. For information about health checks with Shield Advanced, see [Configuring health\-based detection using health checks](ddos-advanced-health-checks.md)\.